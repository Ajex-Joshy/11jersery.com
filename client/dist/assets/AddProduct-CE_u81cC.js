import{ae as T,af as k,aM as p,j as e,ag as l,aN as n,aL as d,h as P,Z as F,z as q}from"./index-199rnzlN.js";import{p as C,P as D,S as L,C as A}from"./ProductImageDropzone-BPqTsEh-.js";import{d as M,a as $}from"./productHooks-BMCeuHdQ.js";import"./ImageCropperModal-C4EWuTtp.js";import"./categoryHooks-CqBOlkk9.js";const E=["XS","S","M","L","XL","XXL"],Q=()=>{const{mutate:g,isLoading:c}=M(),{data:x}=$(),{register:a,handleSubmit:u,control:o,setError:b,formState:{errors:t}}=T({resolver:k(C),defaultValues:{isListed:"true",priceList:"",priceSale:"",variants:E.map(s=>({size:s,stock:0})),categoryIds:[],tags:[],faqs:[],detailsMaterial:"",detailsFitType:"",detailsNeckType:"",detailsSleeveType:"",detailsInstructions:"",images:[],coverImageIndex:0}});console.log(t);const{fields:h}=p({control:o,name:"variants"}),{fields:j,append:f,remove:y}=p({control:o,name:"faqs"}),v=x?.data?.categories.map(s=>({value:s._id,label:s.title}))||[],N=s=>{const r=new FormData,S=[{attribute:"Material",description:s.detailsMaterial},{attribute:"Fit Type",description:s.detailsFitType},{attribute:"Neck Type",description:s.detailsNeckType},{attribute:"Sleeve Type",description:s.detailsSleeveType},{attribute:"Instructions",description:s.detailsInstructions}].filter(i=>i.description&&i.description.trim()!==""),w={title:s.title,description:s.description,shortDescription:s.shortDescription,price:{list:s.priceList,sale:s.priceSale},variants:s.variants.filter(i=>i.stock>0),categoryIds:s.categoryIds,tags:s.tags,isListed:s.isListed,details:S,coverImageIndex:s.coverImageIndex},I=s.faqs;r.append("productData",JSON.stringify(w)),r.append("faqsData",JSON.stringify(I)),s.images&&s.images.length>0&&s.images.forEach(i=>{r.append("images",i)}),g(r,{onError:i=>{const m=i.response?.data?.error;m?.code==="PRODUCT_SLUG_EXISTS"?b("title",{type:"manual",message:m.message}):q.error(i.response?.data?.message||"An unexpected error occurred")}})};return e.jsxs("div",{className:"p-6 bg-gray-50/50 min-h-screen",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Add New Product"}),e.jsxs("form",{onSubmit:u(N),className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6 bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h2",{className:"text-lg font-semibold border-b pb-2",children:"Basic Details"}),e.jsx(l,{label:"Product Title",id:"title",...a("title"),error:t.title?.message,s:!0}),e.jsx(n,{label:"Product Description",id:"description",...a("description"),error:t.description?.message,rows:4}),e.jsx("h2",{className:"text-lg font-semibold border-b pb-2 pt-4",children:"Pricing"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(l,{label:"Product list price",id:"priceList",type:"number",step:"0.01",...a("priceList"),error:t.priceList?.message}),e.jsx(l,{label:"Product sale price",id:"priceSale",type:"number",step:"0.01",...a("priceSale"),error:t.priceSale?.message})]})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6 bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx(d,{name:"images",control:o,render:({field:s})=>e.jsx(d,{name:"coverImageIndex",control:o,render:({field:r})=>e.jsx(D,{label:"Upload Product Images ",onChangeFiles:s.onChange,valueFiles:s.value,onChangeCoverIndex:r.onChange,valueCoverIndex:r.value,error:t.images?.message||t.images?.root?.message,aspect:1/1})})}),e.jsx(n,{label:"Short Description",id:"shortDescription",...a("shortDescription"),error:t.shortDescription?.message,rows:3})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h2",{className:"text-lg font-semibold border-b pb-2 mb-6",children:"Inventory"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4",children:[" ",h.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 bg-gray-50 rounded-md border border-gray-200",children:[e.jsx("label",{htmlFor:`variants.${r}.stock`,className:"w-10 text-center font-bold text-gray-800 uppercase flex-shrink-0",children:s.size}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:`variants.${r}.stock`,type:"number",min:"0",placeholder:"Stock",className:`border p-2 rounded-md w-24 text-center ${t.variants?.[r]?.stock?"border-red-500 ring-1 ring-red-500":"border-gray-300 focus:border-green-500 focus:ring-1 focus:ring-green-500"}`,...a(`variants.${r}.stock`)}),t.variants?.[r]?.stock&&e.jsx("p",{className:"text-red-500 text-xs mt-1 text-left",children:t.variants[r].stock.message})]})]},s.id))]}),t.variants&&!t.variants.length&&typeof t.variants.message=="string"&&e.jsx("p",{className:"text-red-500 text-sm mt-2",children:t.variants.message})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold border-b pb-2",children:"Categories"}),e.jsx(d,{name:"categoryIds",control:o,render:({field:s})=>e.jsx(L,{...s,isMulti:!0,options:v,className:"basic-multi-select",classNamePrefix:"select",placeholder:"Select categories..."})}),t.categoryIds&&e.jsx("span",{className:"text-red-500 text-sm",children:t.categoryIds.message}),e.jsx("h2",{className:"text-lg font-semibold border-b pb-2 pt-4",children:"Product Tags"}),e.jsx(d,{name:"tags",control:o,render:({field:s})=>e.jsx(A,{...s,isMulti:!0,placeholder:"Type and press enter to add tags..."})}),t.tags&&e.jsx("span",{className:"text-red-500 text-sm",children:t.tags.message})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold border-b pb-2",children:"Product Details"}),e.jsx(l,{label:"Material",id:"detailsMaterial",...a("detailsMaterial"),error:t.detailsMaterial?.message}),e.jsx(l,{label:"Fit type",id:"detailsFitType",...a("detailsFitType"),error:t.detailsFitType?.message}),e.jsx(l,{label:"Neck type",id:"detailsNeckType",...a("detailsNeckType"),error:t.detailsNeckType?.message}),e.jsx(l,{label:"Sleeve type",id:"detailsSleeveType",...a("detailsSleeveType"),error:t.detailsSleeveType?.message}),e.jsx(n,{label:"Instructions",id:"detailsInstructions",...a("detailsInstructions"),error:t.detailsInstructions?.message,rows:3})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"FAQs (Optional)"}),e.jsxs("button",{type:"button",onClick:()=>f({question:"",answer:""}),className:"text-sm text-green-600 hover:text-green-800 font-medium flex items-center gap-1",children:[e.jsx(P,{size:16})," Add FAQ"]})]}),j.map((s,r)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 border-b pb-4",children:[e.jsx("div",{className:"md:col-span-5",children:e.jsx(l,{label:`Question ${r+1}`,id:`faqs.${r}.question`,...a(`faqs.${r}.question`),error:t.faqs?.[r]?.question?.message})}),e.jsx("div",{className:"md:col-span-6",children:e.jsx(n,{label:`Answer ${r+1}`,id:`faqs.${r}.answer`,...a(`faqs.${r}.answer`),error:t.faqs?.[r]?.answer?.message,rows:2})}),e.jsx("div",{className:"md:col-span-1 flex items-end justify-center pb-2",children:e.jsx("button",{type:"button",onClick:()=>y(r),className:"text-red-500 hover:text-red-700",children:e.jsx(F,{size:18})})})]},s.id))]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border flex flex-col md:flex-row justify-between items-center gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsx(d,{name:"isListed",control:o,render:({field:s})=>e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"true",checked:s.value==="true",onChange:()=>s.onChange("true"),className:"text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Listed"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:"false",checked:s.value==="false",onChange:()=>s.onChange("false"),className:"text-red-600 focus:ring-red-500"}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Unlisted"})]})]})})]}),e.jsx("button",{type:"submit",disabled:c,className:"bg-black text-white py-2 px-8 rounded-lg font-medium hover:bg-gray-800 transition disabled:bg-gray-400",children:c?"Publishing...":"Publish Product"})]})]})]})};export{Q as default};
