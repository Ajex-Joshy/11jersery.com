import{j as e,l as p,h as y,P as r,Z as u,L as m,g as R,d as v,_ as N,$ as q,a0 as _,a1 as I,W as z,M as x,z as C}from"./index-B5Zfx6Dp.js";import{M as w}from"./minus-DaSvixiy.js";const g=({value:s,onDecrease:i,onIncrease:d,isLoading:a,maxQuantity:n})=>e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-md",children:[e.jsx("button",{onClick:i,disabled:a||s<=1,className:"px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-l-md disabled:opacity-50",children:e.jsx(w,{size:16})}),e.jsx("span",{className:"px-5 text-md font-semibold w-16 text-center",children:a?e.jsx(p,{size:16,className:"animate-spin mx-auto"}):s}),e.jsx("button",{onClick:d,disabled:a||n&&s>=n,className:"px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-r-md disabled:opacity-50",children:e.jsx(y,{size:16})})]});g.propTypes={value:r.number.isRequired,onDecrease:r.func.isRequired,onIncrease:r.func.isRequired,isLoading:r.bool.isRequired,maxQuantity:r.number};const b=({item:s,onIncrement:i,onDecrement:d,onRemove:a,isMutating:n})=>{if(!s)return e.jsxs("div",{className:"flex gap-4 p-4 border border-gray-200 rounded-lg items-center justify-between text-red-500",children:[e.jsxs("span",{children:["This item (ID: ",s._id,") is no longer available."]}),e.jsx("button",{onClick:()=>a(s._id),className:"p-2 hover:bg-red-50 rounded-full",children:e.jsx(u,{size:18})})]});const o=s?.imageUrl;return e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 p-4 border border-gray-200 rounded-lg",children:[e.jsx(m,{to:`/product/${s?.slug}`,className:"w-full sm:w-28 h-28 shrink-0",children:e.jsx("img",{src:o,alt:s?.title,className:"w-full h-full object-cover rounded-md bg-gray-100",onError:l=>{l.target.src="https://acube.delighterp.com/uploaded/acube_delighterp_com/product/default_product_image.jpg"}})}),e.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx(m,{to:`/product/${s?.slug}`,className:"text-md font-semibold text-gray-900 hover:underline",children:s?.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Size: ",s.size]})]}),e.jsx("span",{className:"text-md font-bold text-gray-800 mt-2 sm:mt-0",children:R(s?.salePrice)})]}),e.jsxs("div",{className:"flex sm:flex-col justify-between sm:justify-start items-end sm:items-end gap-2",children:[e.jsx("button",{onClick:()=>a(s._id),disabled:n,className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-full disabled:opacity-50",children:n?e.jsx(p,{size:18,className:"animate-spin"}):e.jsx(u,{size:18})}),e.jsx(g,{value:s.quantity,onDecrease:()=>d(s),onIncrease:()=>i(s),isLoading:!1})]})]})};b.propTypes={item:r.shape({_id:r.string.isRequired,slug:r.string.isRequired,title:r.string.isRequired,imageUrl:r.string.isRequired,size:r.string.isRequired,quantity:r.number.isRequired,salePrice:r.number.isRequired}).isRequired,onIncrement:r.func,onDecrement:r.func,onRemove:r.func,isMutating:r.bool};const P=()=>{const{data:s,isLoading:i,isError:d,error:a}=v(),{mutate:n}=N(),{mutate:o}=q(),{mutate:l}=_(),f=t=>{if(t.quantity>=x){C.error(`Maximum quantity allowed per item is ${x}`);return}n({itemId:t._id})},h=t=>{t.quantity>1?o({itemId:t._id}):c(t._id)},c=t=>{l({itemId:t})},j=s?.data?.items||[];return i?e.jsx(I,{text:"Loading checkout..."}):d?e.jsx(z,{error:a}):e.jsx("div",{className:"space-y-4",children:j.map(t=>e.jsx(b,{item:t,onIncrement:f,onDecrement:h,onRemove:c},t._id))})};export{P as C};
