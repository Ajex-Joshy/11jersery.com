import{a as i,u as g,i as u,k as y,z as o,O as d}from"./index-BqlAPq8n.js";const m=async({queryKey:e})=>{const[,a]=e,{data:t}=await i.get("/admin/categories",{params:a});return t},C=async e=>{console.log("data");const{data:a}=await i.post("/admin/categories",e);return console.log(a),a},p=async({categoryId:e,isListed:a})=>{const{data:t}=await i.patch(`/admin/categories/${e}/status`,{isListed:a});return t},q=async e=>{const{data:a}=await i.delete(`/admin/categories/${e}`);return a},v=async e=>{const{data:a}=await i.get(`/admin/categories/${e}`);return a},D=async({id:e,formData:a})=>{console.log("update cat");for(const[r,s]of a.entries())console.log("formData",r,s);const{data:t}=await i.patch(`/admin/categories/${e}`,a);return t},c="categories",l="categoryDetails",Q=e=>g({queryKey:[c,e],queryFn:m,keepPreviousData:!0,staleTime:1e3*60*5}),f=()=>{const e=u(),a=d();return y({mutationFn:C,onSuccess:async()=>{o.success("Category added successfully!"),await e.invalidateQueries({queryKey:[c]}),a("/admin/categories")}})},K=()=>{const e=u();return y({mutationFn:p,onMutate:async({categoryId:a})=>{await e.cancelQueries({queryKey:[c]});const t=e.getQueriesData({queryKey:[c]});return t.forEach(([r,s])=>{!s||!s.data?.categories||e.setQueryData(r,{...s,data:{...s.data,categories:s.data.categories.map(n=>n._id===a?{...n,isListed:!n.isListed}:n)}})}),{previousData:t}},onError:(a,t,r)=>{r?.previousData&&r.previousData.forEach(([s,n])=>{e.setQueryData(s,n)}),o.error(a.response?.data?.message||"Failed to update category status. Rolled back.")},onSuccess:a=>{o.success(a.message||"Category status updated!")}})},w=()=>{const e=u();return y({mutationFn:q,onSuccess:async a=>{o.success(a.message||"Category deleted successfully!"),await e.invalidateQueries({queryKey:[c]})},onError:a=>{o.error(a.response?.data?.message||"Failed to delete category.")}})},F=e=>g({queryKey:[l,e],queryFn:()=>v(e),enabled:!!e,staleTime:1e3*60*5}),S=()=>{const e=u(),a=d();return y({mutationFn:D,onSuccess:(t,r)=>{o.success(t.message||"Category updated successfully!"),e.invalidateQueries({queryKey:[c]}),e.invalidateQueries({queryKey:[l,r.slug]}),a("/admin/categories")},onError:t=>{o.error(t.response?.data?.message||"Failed to update category.")}})};export{c as C,K as a,w as b,f as c,F as d,S as e,Q as u};
