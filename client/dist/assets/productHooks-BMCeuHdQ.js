import{a as n,u as l,i as d,k as i,z as a,O as p}from"./index-199rnzlN.js";import{C as g}from"./categoryHooks-CqBOlkk9.js";const P=async({queryKey:e})=>{const[,s]=e;return(await n.get("/admin/products",{params:s})).data},q=async({productId:e,isListed:s})=>{const{data:t}=await n.patch(`/admin/products/${e}/status`,{isListed:s});return t},C=async e=>{const{data:s}=await n.delete(`/admin/products/${e}`);return s},E=async()=>(await n.get("/admin/categories")).data,Q=async({queryKey:e})=>{const[s,t]=e;return(await n.get(`/admin/products/${t}`)).data},f=async e=>{const{data:s}=await n.post("/admin/products",e,{headers:{"Content-Type":"multipart/form-data"}});return s},v=async({id:e,formData:s})=>{console.log(e);const{data:t}=await n.patch(`/admin/products/${e}`,s,{headers:{"Content-Type":"multipart/form-data"}});return console.log(t),t},u="products",y="productDetails",w=e=>l({queryKey:[u,e],queryFn:P,keepPreviousData:!0}),T=e=>l({queryKey:[y,e],queryFn:Q}),_=()=>l({queryKey:[g,"all"],queryFn:E,staleTime:1/0}),S=()=>{const e=d();return i({mutationFn:q,onMutate:async({productId:s})=>{await e.cancelQueries({queryKey:[u]});const t=e.getQueriesData({queryKey:[u]}),r=t;return t.forEach(([m,o])=>{console.log("oldData",o),!(!o||!o.data||!o.data.products)&&e.setQueryData(m,{...o,data:{...o.data,products:o.data.products.map(c=>c._id===s?{...c,isListed:!c.isListed}:c)}})}),{previousProducts:r}},onError:(s,t,r)=>{r?.previousProducts&&e.setQueryData([u],r.previousProducts),a.error(s.response?.data?.message||"Failed to update product status.")},onSuccess:s=>{a.success(s.message||"Product status updated!")}})},D=()=>{const e=d();return i({mutationFn:C,onSuccess:async s=>{a.success(s.message||"Product deleted successfully!"),await e.invalidateQueries({queryKey:[u]})},onError:s=>{a.error(s.response?.data?.message||"Failed to delete product.")}})},h=()=>{const e=d(),s=p();return i({mutationFn:f,onSuccess:t=>{a.success(t.message||"Product added successfully!"),e.invalidateQueries({queryKey:[u]}),s("/admin/products")},onError:t=>{a.error(t.response?.data?.message||"Failed to add product.")}})},A=()=>{const e=d(),s=p();return i({mutationFn:v,onSuccess:(t,r)=>{a.success(t.message||"Product updated successfully!"),e.invalidateQueries({queryKey:[u]}),e.invalidateQueries({queryKey:[y,r.slug]}),s("/admin/products")},onError:t=>{console.log(t),a.error(t.response?.data?.message||"Failed to update product.")}})};export{_ as a,S as b,D as c,h as d,T as e,A as f,w as u};
