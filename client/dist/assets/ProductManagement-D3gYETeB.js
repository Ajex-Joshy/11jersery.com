import{j as e,P as i,O as D,av as T,r as _,L as A,h as E,aw as O,C as B,g as I}from"./index-199rnzlN.js";import{u as M,a as R,b as q,c as z}from"./productHooks-BMCeuHdQ.js";import{L as U,a as X}from"./UiElements-BI6dWPc4.js";import"./categoryHooks-CqBOlkk9.js";import"./pen-HmXN4Xp4.js";const V={XS:"bg-yellow-400 text-yellow-900",S:"bg-green-400 text-green-900",M:"bg-blue-400 text-blue-900",L:"bg-purple-400 text-purple-900",XL:"bg-pink-400 text-pink-900",XXL:"bg-gray-400 text-gray-900"},h=({variants:a})=>!a||a.length===0?e.jsx("span",{className:"text-gray-500 text-xs",children:"No variants"}):e.jsx("div",{className:"flex flex-wrap gap-2 items-center",children:a.map(r=>e.jsxs("div",{className:"flex items-center gap-1 border border-gray-200 rounded px-1.5 py-0.5",children:[e.jsx("span",{className:`text-[10px] font-bold px-1 rounded ${V[r.size]||"bg-gray-200 text-gray-800"}`,children:r.size}),e.jsx("span",{className:"text-xs text-gray-600",children:r.stock})]},r._id||r.sku))});h.propTypes={variants:i.arrayOf(i.shape({_id:i.string,sku:i.string,size:i.string.isRequired,stock:i.number.isRequired})).isRequired};const F=({imageUrl:a,title:r})=>e.jsx("img",{src:a,alt:r,className:"w-12 h-12 object-cover rounded-md border border-gray-200",onError:n=>{n.target.src="https://acube.delighterp.com/uploaded/acube_delighterp_com/product/default_product_image.jpg"}}),Q=()=>{const a=D(),{queryParams:r,uiState:n,handlers:d}=T({defaultSortBy:"createdAt",defaultSortOrder:"desc"}),[s,g]=_.useState({isOpen:!1,item:null,action:null}),{data:l,isLoading:u,isError:m,error:p}=M(r);console.log(l);const{data:y}=R(),b=y?.data?.categories||[],{mutate:f,isLoading:L}=q(),{mutate:j,isLoading:P}=z();if(u)return e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Products"}),e.jsx("p",{className:"text-gray-500 mt-4",children:"Loading product data..."})]});if(m)return e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Products"}),e.jsxs("p",{className:"text-red-500 mt-4",children:["Error loading data: ",p.message]})]});const x=(t,o)=>g({isOpen:!0,item:t,action:o}),c=()=>g({isOpen:!1,item:null,action:null}),N=()=>{const{item:t,action:o}=s;t&&(o==="toggleList"?f({productId:t._id,isListed:!t.isListed},{onSettled:c}):o==="delete"&&j(t._id,{onSettled:c}))},k=[{header:"Image",key:"image",sortable:!1,render:t=>e.jsx(F,{imageUrl:t.imageUrls?.[0],title:t.title})},{header:"Product Name",key:"title",sortable:!0,render:t=>e.jsx("span",{className:"font-medium text-gray-900  w-40  break-words whitespace-normal",children:t.title})},{header:"Category",key:"category",sortable:!1,render:t=>{const o=t.categoryIds?.map(S=>b.find(v=>v._id===S)?.title).filter(Boolean).join(", ");return e.jsx("span",{className:"text-sm text-gray-600 w-40 break-words whitespace-normal",children:o||"N/A"})}},{header:"Price",key:"price",sortable:!0,render:t=>e.jsx("span",{className:"text-gray-800 font-semibold",children:I(t?.price?.sale)})},{header:"Stock",key:"stock",sortable:!1,render:t=>e.jsx(h,{variants:t.variants})},{header:"List",key:"isListed",sortable:!0,render:t=>e.jsx(U,{isListed:t.isListed,onClick:()=>x(t,"toggleList")})},{header:"Action",key:"action",sortable:!1,render:t=>e.jsx(X,{onEdit:()=>a(`/admin/edit-product/${t.slug}`),onDelete:()=>x(t,"delete")})}],w=l?.data?.products||[],C=l?.data?.pagination;return e.jsxs("div",{className:"p-6 bg-gray-50/50 min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Products"}),e.jsxs(A,{to:"/admin/add-product",className:"bg-black text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 hover:bg-gray-800 transition",children:[e.jsx(E,{className:"w-4 h-4"}),"Add Product"]})]}),e.jsx(O,{title:"Product List",columns:k,data:w,isLoading:u,isError:m,error:p,searchValue:n.searchTerm,onSearchChange:d.onSearchChange,sortConfig:n.sortConfig,onSort:d.onSort,pagination:C,onPageChange:d.onPageChange,limit:n.limit,onLimitChange:d.onLimitChange}),e.jsx(B,{isOpen:s.isOpen,onClose:c,onConfirm:N,isLoading:L||P,title:s.action==="delete"?"Delete Product":s.action==="toggleList"?s.item?.isListed?"Unlist Product":"List Product":"",message:s.action==="delete"?"Are you sure you want to permanently delete this product? This action cannot be undone.":s.action==="toggleList"?s.item?.isListed?"Are you sure you want to unlist this product? It will no longer be visible to customers.":"Do you want to list this product and make it visible to customers?":"",confirmButtonText:s.action==="delete"?"Delete":s.item?.isListed?"Unlist":"List",confirmButtonVariant:s.action==="delete"?"danger":"primary"})]})};export{Q as default};
