import{ak as v,ae as A,af as P,r as T,j as e,aL as g,ag as c}from"./index-199rnzlN.js";import{c as C,I as w}from"./ImageDropzone-EKc0_TC5.js";import{c as R}from"./categoryHooks-CqBOlkk9.js";import"./ImageCropperModal-C4EWuTtp.js";const F=()=>{const{mutate:b,isLoading:m}=R(),[u,h]=v.useState(""),{register:t,handleSubmit:f,control:p,formState:{errors:a},setError:y,watch:x,setValue:r,unregister:o}=A({resolver:P(C),defaultValues:{offerEnabled:!1,isListed:"true",inHome:!1,inCollections:!1,discountType:"",discountAmount:void 0,minPurchaseAmount:void 0,discountPercentage:void 0,maxRedeemable:void 0,image:null}}),d=x("offerEnabled"),i=x("discountType");T.useEffect(()=>{d?(t("discountType"),i==="flat"?(t("discountAmount"),t("minPurchaseAmount"),o(["discountPercentage","maxRedeemable"]),r("discountPercentage",void 0),r("maxRedeemable",void 0)):i==="percent"?(t("discountPercentage"),t("maxRedeemable"),o(["discountAmount","minPurchaseAmount"]),r("discountAmount",void 0),r("minPurchaseAmount",void 0)):o(["discountAmount","minPurchaseAmount","discountPercentage","maxRedeemable"])):(o(["discountType","discountAmount","minPurchaseAmount","discountPercentage","maxRedeemable"]),r("discountType",void 0),r("discountAmount",void 0),r("minPurchaseAmount",void 0),r("discountPercentage",void 0),r("maxRedeemable",void 0))},[d,i,t,o,r]),console.log(a);const j=s=>{const n=new FormData;n.append("title",s.title),s.offerEnabled&&s.discountType?(n.append("discountType",s.discountType),s.discountType==="flat"?(n.append("discount",s.discountAmount??0),n.append("minPurchaseAmount",s.minPurchaseAmount??0)):s.discountType==="percent"&&(n.append("discount",s.discountPercentage??0),n.append("maxRedeemable",s.maxRedeemable??0))):(n.append("discountType",""),n.append("discount",0),n.append("minPurchaseAmount",0),n.append("maxRedeemable",0)),n.append("isListed",s.isListed),n.append("inHome",s.inHome),n.append("inCollections",s.inCollections),s.image instanceof File&&n.append("image",s.image),console.log("test"),b(n,{onError:N=>{const l=N.response?.data?.error;l?y("title",{type:"manual",message:l.message||"A category with this title already exists."}):h(l?.message||"Something went wrong. Please try again.")}})};return e.jsxs("div",{className:"p-6 bg-gray-50/50 min-h-screen",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Add New Category"}),e.jsxs("form",{onSubmit:f(j),className:"bg-white p-8 rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Header Image"}),e.jsx(g,{name:"image",control:p,render:({field:s})=>e.jsx(w,{onChange:s.onChange,value:s.value,aspect:16/9})}),a.image&&e.jsx("span",{className:"text-red-500 text-sm mt-1",children:a.image.message})]}),e.jsx("div",{className:"mb-6 border-t pt-6",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",...t("offerEnabled"),className:"form-checkbox rounded text-green-600 h-5 w-5 focus:ring-green-500"}),e.jsx("span",{className:"text-md font-medium text-gray-700",children:"Enable Offer for this Category"})]})}),d&&e.jsxs("div",{className:"mb-6 pt-6 border-t animate-fadeIn",children:[e.jsxs("div",{className:"mb-6 max-w-xs",children:[e.jsx("label",{htmlFor:"discountType",className:"mb-1 block text-sm font-medium text-gray-700",children:"Discount Type"}),e.jsxs("select",{id:"discountType",className:`border p-2 rounded-md w-full ${a.discountType?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-green-500 focus:ring-green-500"} focus:outline-none focus:ring-1`,...t("discountType"),children:[e.jsx("option",{value:"",disabled:!0,children:"Select discount type..."}),e.jsx("option",{value:"flat",children:"Flat Amount (₹)"}),e.jsx("option",{value:"percent",children:"Percentage (%)"})]}),a.discountType&&e.jsx("span",{className:"text-red-500 text-sm mt-1",children:a.discountType.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i==="flat"&&e.jsxs(e.Fragment,{children:[e.jsx(c,{label:"Discount Amount (₹)",id:"discountAmount",type:"number",step:"0.01",placeholder:"e.g., 100",...t("discountAmount"),error:a.discountAmount?.message}),e.jsx(c,{label:"Minimum Purchase Amount (₹)",id:"minPurchaseAmount",type:"number",step:"0.01",placeholder:"e.g., 500",...t("minPurchaseAmount"),error:a.minPurchaseAmount?.message})]}),i==="percent"&&e.jsxs(e.Fragment,{children:[e.jsx(c,{label:"Discount Percentage (%)",id:"discountPercentage",type:"number",min:"0",max:"100",step:"0.1",placeholder:"e.g., 10",...t("discountPercentage"),error:a.discountPercentage?.message}),e.jsx(c,{label:"Max Redeemable Amount (₹)",id:"maxRedeemable",type:"number",step:"0.01",placeholder:"e.g., 50 (Max discount user gets)",...t("maxRedeemable"),error:a.maxRedeemable?.message})]})]})]}),e.jsx("div",{className:`mb-6 ${d?"border-t pt-6":""}`,children:e.jsx(c,{label:"Category Name",id:"title",type:"text",placeholder:"e.g., Club Jerseys, National Teams",...t("title"),error:a.title?.message})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-6 mb-8 border-t pt-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsx(g,{name:"isListed",control:p,render:({field:s})=>e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",onChange:()=>s.onChange("true"),checked:s.value==="true",className:"form-radio text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-gray-700",children:"Listed"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",onChange:()=>s.onChange("false"),checked:s.value==="false",className:"form-radio text-gray-600 focus:ring-gray-500"}),e.jsx("span",{className:"text-gray-700",children:"Unlisted"})]})]})}),a.isListed&&e.jsx("span",{className:"text-red-500 text-sm mt-1",children:a.isListed.message})]}),e.jsxs("div",{className:"flex flex-col gap-4 pt-4 md:pt-0 md:items-start md:ml-auto",children:[" ",e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",...t("inHome"),className:"form-checkbox rounded text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Show in Homepage 'Discover' section"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",...t("inCollections"),className:"form-checkbox rounded text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Show in 'Browse by Collections' section"})]})]})]}),u&&e.jsx("div",{className:"text-red-600 text-sm mb-4",children:u}),e.jsx("div",{className:"flex justify-end border-t pt-6",children:e.jsx("button",{type:"submit",disabled:m,className:"bg-black text-white py-2 px-8 rounded-lg font-medium hover:bg-gray-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Adding...":"Add Category"})})]})]})};export{F as default};
